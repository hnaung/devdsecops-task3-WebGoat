# Task 3: Integration of DevSecOps Scanning Processes

## 1. Overview
This document outlines the steps and configurations involved in integrating various DevSecOps security scanning processes into the CI/CD pipeline for a three-tier application deployment using the WebGoat application source code. The objective is to ensure the security of both the Terraform infrastructure code and the deployed application code by identifying vulnerabilities, misconfigurations, and other security issues.

## 2. Project Setup
- **Repository:** Forked from WebGoat GitHub Repository
- **CI/CD Tool:** GitHub Actions
- **Security Scanning Tools:** Snyk, TruffleHog

## 3. CI/CD Pipeline Configuration
The CI/CD pipeline is configured using GitHub Actions. The pipeline triggers on a pull request to the master branch. 
The pipeline includes various security scanning steps. For detailed information, you can view the workflow configuration at the following link:

[Main Workflow Configuration](https://github.com/hnaung/devsecops-task3-WebGoat/blob/master/.github/workflows/main.yml)

## 4. Security Scanning Processes
The following security scanning processes are integrated into the CI/CD pipeline:

### Static Application Security Testing (SAST)
- **Tool:** Snyk
- **Description:** Snyk scans the application source code for security vulnerabilities and coding best practices.
- **Report:** `reports/snyk-sast-scan-report.json`

### Dependency Checking
- **Tool:** Snyk
- **Description:** Snyk scans the application dependencies for any known vulnerabilities.
- **Report:** `reports/snyk-dependency-scan-report.json`

### Password and Sensitive Information Scanning
- **Tool:** TruffleHog
- **Description:** TruffleHog scans the source code and Terraform scripts for hardcoded passwords or sensitive information. A custom rule set is used to detect various sensitive credentials, such as AWS API keys, SSH private keys, OAuth tokens, and more.
- **Custom Rules Configuration:** `trufflehog-rules.json`

- **Report:** `reports/trufflehog-report.json`

### Container Scanning
- **Not applicable in this task as Docker images are not used.**

## 5. Pipeline Configuration
- **Trigger:** The CI/CD pipeline is configured to trigger on a pull request to the master branch.
- **Build Halt:** The pipeline is configured to halt the build process if any high-severity vulnerabilities are found during the dependency checking process.
- **Reports Directory:** All scan reports are stored in the `reports` directory within the application source code repository.

## 6. Accessing and Interpreting Scan Reports
All scan reports generated by the pipeline are stored in the `reports` directory. To access these reports:

1. Navigate to the `reports` directory in the GitHub repository.
2. Open the desired report (`snyk-sast-scan-report.json`, `snyk-dependency-scan-report.json`, or `trufflehog-report.json`) to review the results.

Each report is in JSON format, providing detailed information about identified vulnerabilities or issues, including severity levels and recommendations for remediation.

### 7. Token Configuration
To ensure the security scanning processes function correctly within the CI/CD pipeline, you'll need to configure the following tokens:

## GitHub Personal Access Token (GH_TOKEN)

The GitHub Personal Access Token is required to authenticate with the GitHub API, allowing the pipeline to push reports and updates to the repository.

### How to Obtain:

1. Go to your GitHub account settings.
2. Navigate to **Developer settings** > **Personal access tokens** > **Tokens (classic)**.
3. Click on **Generate new token**.
4. Select the necessary scopes, such as `repo` for full control of private repositories.
5. Click on **Generate token** and copy the token.

### Usage:

Store the token securely in your GitHub repository secrets as `GH_TOKEN`.

## Snyk API Token (SNYK_TOKEN)

The Snyk API Token is required to authenticate with Snyk for performing security scans.

### How to Obtain:

1. Sign in to your Snyk account.
2. Navigate to your **Account settings**.
3. Under the **API token** section, click **Generate** to create a new token.
4. Copy the generated token.

### Usage:

Store the token securely in your GitHub repository secrets as `SNYK_TOKEN`.

## Reference Documentation:

For more details on obtaining and authenticating with your Snyk API Token, refer to the [Snyk Documentation](https://snyk.io/docs/).

## 8. Conclusion
This CI/CD pipeline ensures the security of the WebGoat application by automating the security scanning processes. The integration of Snyk and TruffleHog within the pipeline allows for continuous monitoring of the codebase for vulnerabilities, enhancing the overall security posture of the application.